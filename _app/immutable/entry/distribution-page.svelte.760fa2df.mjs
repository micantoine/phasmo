import{S as G,i as K,s as Q,k as w,q as A,a as S,l as I,m as B,r as H,h as p,c as j,n as $,b as P,D as E,u as Y,H as J,X as Z,y as x,W as se,z as ee,A as te,J as le,g as C,f as ae,d as O,B as ne,I as V,o as ie,v as re}from"../chunks/index.18ccf95c.mjs";import{b as oe}from"../chunks/paths.abee2adf.mjs";import{e as L,B as ce,a as W,d as ue,b as fe}from"../chunks/FormInput.svelte_svelte_type_style_lang.d1e2de79.mjs";const me=i=>{const e=[...i];for(let s=e.length-1;s>0;s--){const n=Math.floor(Math.random()*(s+1)),o=e[s];e[s]=e[n],e[n]=o}return e},he=i=>{const e=Math.floor(Math.random()*i.length);return i[e]};function N(i,e,s){const n=i.slice();return n[2]=e[s],n}function U(i){let e,s=L.name(i[2])+"",n;return{c(){e=w("li"),n=A(s)},l(o){e=I(o,"LI",{});var r=B(e);n=H(r,s),r.forEach(p)},m(o,r){P(o,e,r),E(e,n)},p(o,r){r&2&&s!==(s=L.name(o[2])+"")&&Y(n,s)},d(o){o&&p(e)}}}function de(i){let e,s,n,o,r,d=i[1],f=[];for(let a=0;a<d.length;a+=1)f[a]=U(N(i,d,a));return{c(){e=w("div"),s=w("h3"),n=A(i[0]),o=S(),r=w("ul");for(let a=0;a<f.length;a+=1)f[a].c();this.h()},l(a){e=I(a,"DIV",{class:!0});var m=B(e);s=I(m,"H3",{class:!0});var c=B(s);n=H(c,i[0]),c.forEach(p),o=j(m),r=I(m,"UL",{class:!0});var q=B(r);for(let v=0;v<f.length;v+=1)f[v].l(q);q.forEach(p),m.forEach(p),this.h()},h(){$(s,"class","svelte-1tbjvq7"),$(r,"class","svelte-1tbjvq7"),$(e,"class","card svelte-1tbjvq7")},m(a,m){P(a,e,m),E(e,s),E(s,n),E(e,o),E(e,r);for(let c=0;c<f.length;c+=1)f[c].m(r,null)},p(a,[m]){if(m&1&&Y(n,a[0]),m&2){d=a[1];let c;for(c=0;c<d.length;c+=1){const q=N(a,d,c);f[c]?f[c].p(q,m):(f[c]=U(q),f[c].c(),f[c].m(r,null))}for(;c<f.length;c+=1)f[c].d(1);f.length=d.length}},i:J,o:J,d(a){a&&p(e),Z(f,a)}}}function pe(i,e,s){let{name:n}=e,{equipmentIds:o}=e;return i.$$set=r=>{"name"in r&&s(0,n=r.name),"equipmentIds"in r&&s(1,o=r.equipmentIds)},[n,o]}class _e extends G{constructor(e){super(),K(this,e,pe,de,Q,{name:0,equipmentIds:1})}}function X(i,e,s){const n=i.slice();return n[12]=e[s],n[14]=s,n}function F(i){let e,s;return e=new _e({props:{name:i[12].name||`Player ${i[14]+1}`,equipmentIds:i[12].equipments}}),{c(){x(e.$$.fragment)},l(n){ee(e.$$.fragment,n)},m(n,o){te(e,n,o),s=!0},p(n,o){const r={};o&1&&(r.name=n[12].name||`Player ${n[14]+1}`),o&1&&(r.equipmentIds=n[12].equipments),e.$set(r)},i(n){s||(C(e.$$.fragment,n),s=!0)},o(n){O(e.$$.fragment,n),s=!1},d(n){ne(e,n)}}}function ge(i){let e;return{c(){e=A("Re-distribute")},l(s){e=H(s,"Re-distribute")},m(s,n){P(s,e,n)},d(s){s&&p(e)}}}function ve(i){let e,s,n,o,r,d,f,a,m,c,q,v,D,R,h,g,b=i[0],l=[];for(let t=0;t<b.length;t+=1)l[t]=F(X(i,b,t));const k=t=>O(l[t],1,1,()=>{l[t]=null});return m=new ce({props:{color:"primary",$$slots:{default:[ge]},$$scope:{ctx:i}}}),m.$on("click",i[2]),{c(){e=w("meta"),s=S(),n=w("h1"),o=A("Players Equipments"),r=S(),d=w("section");for(let t=0;t<l.length;t+=1)l[t].c();f=S(),a=w("div"),x(m.$$.fragment),c=w("br"),q=S(),v=w("a"),D=A("Review settings"),this.h()},l(t){const u=se("svelte-1jgi5w7",document.head);e=I(u,"META",{name:!0,content:!0}),u.forEach(p),s=j(t),n=I(t,"H1",{});var y=B(n);o=H(y,"Players Equipments"),y.forEach(p),r=j(t),d=I(t,"SECTION",{class:!0});var _=B(d);for(let T=0;T<l.length;T+=1)l[T].l(_);_.forEach(p),f=j(t),a=I(t,"DIV",{class:!0});var M=B(a);ee(m.$$.fragment,M),c=I(M,"BR",{}),q=j(M),v=I(M,"A",{class:!0,href:!0,title:!0});var z=B(v);D=H(z,"Review settings"),z.forEach(p),M.forEach(p),this.h()},h(){document.title="Distribution",$(e,"name","description"),$(e,"content","Equipment distribution"),$(d,"class","players svelte-1liacod"),$(v,"class","secondary svelte-1liacod"),$(v,"href",`${oe}/`),$(v,"title","Settings"),$(a,"class","actions svelte-1liacod")},m(t,u){E(document.head,e),P(t,s,u),P(t,n,u),E(n,o),P(t,r,u),P(t,d,u);for(let y=0;y<l.length;y+=1)l[y].m(d,null);P(t,f,u),P(t,a,u),te(m,a,null),E(a,c),E(a,q),E(a,v),E(v,D),R=!0,h||(g=le(v,"click",i[1]),h=!0)},p(t,[u]){if(u&1){b=t[0];let _;for(_=0;_<b.length;_+=1){const M=X(t,b,_);l[_]?(l[_].p(M,u),C(l[_],1)):(l[_]=F(M),l[_].c(),C(l[_],1),l[_].m(d,null))}for(re(),_=b.length;_<l.length;_+=1)k(_);ae()}const y={};u&32768&&(y.$$scope={dirty:u,ctx:t}),m.$set(y)},i(t){if(!R){for(let u=0;u<b.length;u+=1)C(l[u]);C(m.$$.fragment,t),R=!0}},o(t){l=l.filter(Boolean);for(let u=0;u<l.length;u+=1)O(l[u]);O(m.$$.fragment,t),R=!1},d(t){p(e),t&&p(s),t&&p(n),t&&p(r),t&&p(d),Z(l,t),t&&p(f),t&&p(a),ne(m),h=!1,g()}}}function be(i,e,s){let n,o,r;V(i,ue,h=>s(5,n=h)),V(i,fe,h=>s(6,o=h)),V(i,W,h=>s(0,r=h));const d=new Map;let f=[],a=[],m=new Set;ie(()=>{c(),v()});function c(){const h=new Map;r.forEach((g,b)=>{let l=0;for(;l<g.capacity;)l+=1,h.set(l,[...h.get(l)??[],b])}),h.forEach(g=>{a=a.concat(me(g))})}function q(h){var k;const g=r[h],b=he(f);let l=[b];if(n.allowDependencies){const t=L.dependency(b);t&&!g.equipments.includes(t)&&(g.capacity-1===g.equipments.length?(k=d.get(h))!=null&&k.includes(t)?l=q(h):l=[t]:(l=l.concat([t]),m.add(h)))}return[...l]}function v(){for(let h=0;h<a.length;h++){const g=a[h],b=r[g];if(m.has(g)){m.delete(g);continue}if(f=o.filter(l=>{const k=b.equipments.includes(l);if(n.allowSiblings)return!k;const t=L.siblings(l).find(u=>b.equipments.includes(u));return!k&&!t}),f.length>0){const l=q(g),k=d.get(g)??[];d.set(g,[...k,...l]),W.update(t=>t.map((u,y)=>({...u,equipments:d.get(y)??[]})))}}}function D(){a=[],c(),d.clear(),W.resetEquipment()}function R(){D(),v()}return[r,D,R]}class $e extends G{constructor(e){super(),K(this,e,be,ve,Q,{})}}export{$e as default};
